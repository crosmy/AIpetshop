
# 宠物社交应用API文档

## 简介
这份文档描述了宠物社交应用的后端API接口。这些接口包括用户管理、宠物信息处理、消息交流等功能。

[toc]

## AuthenticationController

AuthenticationController 提供用户认证相关的操作接口。

### 1. 注册用户

- **URL**: `/auth/register`
- **方法**: `POST`
- 参数:
  - `newUser`: 新用户信息（请求体），包括用户名、密码等。
- **描述**: 允许新用户注册。
- **返回**: 注册成功的消息或异常信息。

### 2. 登录

- **URL**: `/auth/login`
- **方法**: `POST`
- 参数:
  - `user`: 用户登录信息（请求体），包括用户名和密码。
- **描述**: 允许用户登录并验证其身份。
- **返回**: 登录成功后的信息，通常包括令牌（token）和用户ID。

## ChatController

ChatController 提供智能客服聊天相关的操作接口。

### 1. 接收消息并返回回复

- **URL**: `/chat/message`
- **方法**: `POST`
- 参数:
  - `messageDto`: 消息传输对象（请求体），包括消息内容和其他相关信息。
- **描述**: 允许用户向智能客服发送消息，并接收回复。
- **返回**: 智能客服的回复消息。

### 2. 获取聊天记录

- **URL**: `/chat/record`
- **方法**: `GET`
- 参数:
  - `userId`: 用户ID（请求参数）
  - `sellerId`: 卖家ID（请求参数）
- **描述**: 根据用户ID和卖家ID按时间顺序获取聊天记录。
- **返回**: 聊天记录列表。

## FavoritesController

FavoritesController 提供收藏相关的操作接口。

### 1. 添加帖子到收藏

- **URL**: `/favorites/favorite/add`
- **方法**: `POST`
- 参数:
  - `userId`: 用户ID（请求参数）
  - `postId`: 帖子ID（请求参数）
- **描述**: 允许用户添加帖子到其收藏夹。
- **返回**: 添加收藏成功的消息。

### 2. 从收藏中移除帖子

- **URL**: `/favorites/favorite/delete`
- **方法**: `DELETE`
- 参数:
  - `userId`: 用户ID（请求参数）
  - `postId`: 帖子ID（请求参数）
- **描述**: 允许用户从其收藏夹中移除帖子。
- **返回**: 移除收藏成功的消息。

### 3. 获取用户的收藏状态

- **URL**: `/favorites/favorite`
- **方法**: `GET`
- 参数:
  - `userId`: 用户ID（请求参数）
  - `postId`: 帖子ID（请求参数）
- **描述**: 检查特定帖子是否被特定用户收藏。
- **返回**: 帖子的收藏状态（布尔值）。

### 4. 获取用户的收藏列表

- **URL**: `/favorites/favorite/list`
- **方法**: `GET`
- 参数:
  - `userId`: 用户ID（请求参数）
- **描述**: 获取特定用户收藏的所有帖子。
- **返回**: 用户收藏的帖子列表。

## MessageController

MessageController 提供消息相关的操作接口。

### 1. 发送消息

- **URL**: `/message/send`
- **方法**: `POST`
- 参数:
  - `message`: 消息信息（请求体），包括发送者ID、接收者ID和消息内容。
- **描述**: 允许用户发送消息给其他用户。
- **返回**: 发送的消息详情。

### 2. 获取对话历史

- **URL**: `/message/conversation`
- **方法**: `GET`
- 参数:
  - `senderId`: 发送者ID（请求参数）
  - `receiverId`: 接收者ID（请求参数）
- **描述**: 获取两个用户之间的对话历史。
- **返回**: 对话历史中的消息列表。

## PetController

PetController 提供宠物相关的操作接口。

### 1. 添加宠物

- **URL**: `/pet/add`
- **方法**: `POST`
- 参数:
  - `pet`: 要添加的宠物信息（请求体）。
- **描述**: 用于注册宠物信息。
- **返回**: 添加成功的消息。

### 2. 删除宠物

- **URL**: `/pet/delete/{petId}`
- **方法**: `DELETE`
- 参数:
  - `petId`: 要删除的宠物ID（路径变量）。
- **描述**: 用于删除宠物。
- **返回**: 删除成功的消息。

### 3. 更新宠物

- **URL**: `/pet/update`
- **方法**: `PUT`
- 参数:
  - `pet`: 要更新的宠物信息（请求体）。
- **描述**: 用于更新宠物信息。
- **返回**: 更新成功的消息。

### 4. 获取宠物

- **URL**: `/pet/get/{petId}`
- **方法**: `GET`
- 参数:
  - `petId`: 要获取信息的宠物ID（路径变量）。
- **描述**: 用于获取指定宠物的详细信息。
- **返回**: 宠物的信息。

### 5. 获取所有宠物

- **URL**: `/pet/getAll`
- **方法**: `GET`
- **描述**: 用于获取所有宠物的信息。
- **返回**: 所有宠物的列表。

### 6. 根据主人ID获取宠物

- **URL**: `/pet/getByOwnerId/{ownerId}`
- **方法**: `GET`
- 参数:
  - `ownerId`: 宠物主人的ID（路径变量）。
- **描述**: 用于获取指定主人的所有宠物。
- **返回**: 宠物列表。

### 7. 根据宠物名搜索宠物

- **URL**: `/pet/search/{petName}`
- **方法**: `GET`
- 参数:
  - `petName`: 宠物的名字（路径变量）。
- **描述**: 用于搜索宠物。
- **返回**: 搜索结果的宠物列表。

### 8. 根据宠物ID搜索宠物

- **URL**: `/pet/searchById/{petId}`
- **方法**: `GET`
- 参数:
  - `petId`: 宠物的ID（路径变量）。
- **描述**: 用于根据ID搜索宠物。
- **返回**: 搜索到的宠物信息。

## PostController

PostController 提供帖子相关的操作接口。

### 1. 创建帖子

- **URL**: `/posts/create`
- **方法**: `POST`
- 参数:
  - `post`: 要创建的帖子信息（请求体）。
- **描述**: 用于创建新的帖子。
- **返回**: 创建成功的消息。

### 2. 获取帖子

- **URL**: `/posts/{postId}`
- **方法**: `GET`
- 参数:
  - `postId`: 要获取的帖子ID（路径变量）。
- **描述**: 用于获取指定ID的帖子。
- **返回**: 指定帖子的详细信息。

### 3. 更新帖子

- **URL**: `/posts/{postId}`
- **方法**: `PUT`
- 参数:
  - `postId`: 要更新的帖子ID（路径变量）。
  - `updatedpost`: 更新后的帖子信息（请求体）。
- **描述**: 用于更新帖子信息。
- **返回**: 更新成功的消息。

### 4. 删除帖子

- **URL**: `/posts/{postId}`
- **方法**: `DELETE`
- 参数:
  - `postId`: 要删除的帖子ID（路径变量）。
- **描述**: 用于删除帖子。
- **返回**: 删除成功的消息。

### 5. 获取所有帖子

- **URL**: `/posts/all`
- **方法**: `GET`
- **描述**: 用于获取所有帖子的信息。
- **返回**: 所有帖子的列表。

### 6. 根据关键字搜索帖子

- **URL**: `/posts/query`
- **方法**: `GET`
- 参数:
  - `keyword`: 帖子关键字（请求参数，可选）。
  - `username`: 用户名（请求参数，可选）。
  - `userId`: 用户ID（请求参数，可选）。
  - `orderField`: 排序字段（请求参数，可选）。
  - `orderType`: 排序方式（请求参数，可选，默认为升序）。
  - `type`: 宠物类别（请求参数，可选）。
  - `pageNum`: 页码（请求参数）。
  - `pageSize`: 每页记录数（请求参数）。
  - `petId`: 宠物ID（请求参数，可选）。
  - `petName`: 宠物名字（请求参数，可选）。
- **描述**: 用于根据各种条件搜索帖子。
- **返回**: 搜索结果的帖子列表。

### 7. 获取帖子平均评分

- **URL**: `/posts/{postId}/averageRating`
- **方法**: `GET`
- 参数:
  - `postId`: 帖子ID（路径变量）。
- **描述**: 用于获取指定帖子的平均评分。
- **返回**: 帖子的平均评分。

### 8. 根据发帖人ID获取帖子

- **URL**: `/posts/getByUserId/{userId}`
- **方法**: `GET`
- 参数:
  - `userId`: 发帖人的ID（路径变量）。
- **描述**: 用于获取指定用户发表的所有帖子。
- **返回**: 用户的帖子列表。

## StarController

StarController 提供评分相关的接口。

### 1. 评分帖子

- **URL**: `/star/ratePost`
- **方法**: `PUT`
- 参数:
  - `postId`: 要评分的帖子ID（请求参数）。
  - `star`: 评分星级（1-5之间的整数）（请求参数）。
  - `userId`: 评分用户的ID（请求参数）。
- **描述**: 用于给帖子评分，分值范围是1到5星。评分操作同时会更新帖子的平均评分。
- **返回**: 评分成功的消息。

## TransactionController

TransactionController 提供交易相关的操作接口。

### 1. 创建交易

- **URL**: `/transaction`
- **方法**: `POST`
- 参数:
  - `transaction`: 交易信息（请求体）
- **描述**: 允许用户创建新的交易。
- **返回**: 创建的交易信息（`Transaction`）。

### 2. 更新交易状态

- **URL**: `/transaction/{id}/status`
- **方法**: `PUT`
- 参数:
  - `transactionId`: 交易ID（路径变量）
  - `status`: 交易状态（请求参数）
- **描述**: 允许用户更新特定交易的状态。
- **返回**: 无返回值（操作成功或抛出异常）。

### 3. 获取交易

- **URL**: `/transaction/{id}`
- **方法**: `GET`
- 参数:
  - `transactionId`: 交易ID（路径变量）
- **描述**: 获取特定ID的交易信息。
- **返回**: 交易信息（`Transaction`）。

### 4. 获取用户的订单列表

- **URL**: `/transaction/order/list`
- **方法**: `GET`
- 参数:
  - `userId`: 用户ID（请求参数）
- **描述**: 获取特定用户的所有交易订单。
- **返回**: 用户的交易列表。

## UserController
提供用户相关的操作接口。

### 1. 更新自己的头像
- **URL**: `/user/photo/{username}`
- **方法**: `POST`
- **参数**: 
  - `username`: 用户名（路径变量）
  - `photo`: 头像图片（请求体）
- **描述**: 允许用户上传或更新自己的头像。
- **返回**: 成功上传头像的消息。

### 2. 根据用户id获取用户信息
- **URL**: `/user/id/{userId}`
- **方法**: `GET`
- **参数**:
  - `userId`: 用户ID（路径变量）
- **描述**: 根据用户ID获取用户的详细信息。
- **返回**: 用户的详细信息（`UserDto`）。
